# Firebase 403 é”™è¯¯ - æ·±åº¦è¯Šæ–­ä¸ä¿®å¤

**é—®é¢˜**: å³ä½¿æ›´æ–°äº† API å¯†é’¥å¹¶å¯ç”¨äº† Email/Passwordï¼Œä»ç„¶å‡ºç° 403 é”™è¯¯

**æ ¹æœ¬åŸå› **: API å¯†é’¥çš„ **API é™åˆ¶é…ç½®ä¸æ­£ç¡®**

---

## ğŸ”´ é—®é¢˜ç¡®è®¤

```
é”™è¯¯ä¿¡æ¯:
POST https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyDP2CRExRah28R374Dq2eibeX-yg5cWqtA
403 (Forbidden)

è¯´æ˜:
- âœ… æ­£åœ¨ä½¿ç”¨æ–°çš„ API å¯†é’¥
- âŒ ä½†è¯¥å¯†é’¥æ²¡æœ‰æƒé™è°ƒç”¨ signUp API
- âŒ è¿™ä¸æ˜¯å¯†ç è®¤è¯æœªå¯ç”¨çš„é—®é¢˜
- âŒ è¿™æ˜¯ API å¯†é’¥æƒé™ä¸è¶³çš„é—®é¢˜
```

---

## âœ… å®Œæ•´ä¿®å¤æ­¥éª¤

### Step 1ï¸âƒ£: é‡æ–°é…ç½® API å¯†é’¥æƒé™ (5åˆ†é’Ÿ) **[å¿…åš]**

#### 1.1 æ‰“å¼€ Firebase Console

```
1. https://console.firebase.google.com
2. é€‰æ‹©ä½ çš„é¡¹ç›® (dental-clinic-demo-ce94b)
```

#### 1.2 æ‰¾åˆ° API å¯†é’¥ç®¡ç†

```
å·¦ä¾§èœå•:
  Project settings (âš™ï¸ é½¿è½®å›¾æ ‡)
    â†“
  ç‚¹å‡»ä¸Šæ–¹ "API keys" æ ‡ç­¾é¡µ
```

#### 1.3 é€‰æ‹©æ­£åœ¨ä½¿ç”¨çš„ Web API å¯†é’¥

```
æ‰¾åˆ°ä½ æ­£åœ¨ä½¿ç”¨çš„å¯†é’¥:
  Key: AIzaSyDP2CRExRah28R374Dq2eibeX-yg5cWqtA
  (æ˜¾ç¤ºåœ¨ firebase-config.js ä¸­çš„é‚£ä¸ª)

ç‚¹å‡»å®ƒæ‰“å¼€ç¼–è¾‘é¡µé¢
```

#### 1.4 é…ç½® API é™åˆ¶ **[å…³é”®æ­¥éª¤]**

```
åœ¨æ‰“å¼€çš„è¯¦æƒ…é¡µé¢ä¸­ï¼Œæ‰¾åˆ° "API restrictions" éƒ¨åˆ†

**å½“å‰é…ç½®** (å¯èƒ½å¯¼è‡´é—®é¢˜):
  â˜‘ Restrict key
  â”œâ”€ Cloud Firestore API (é€‰ä¸­)
  â”œâ”€ Cloud Storage API (é€‰ä¸­)
  â””â”€ Firebase Authentication API (é€‰ä¸­)

  é—®é¢˜: å¯èƒ½ç¼ºå°‘ "Identity Toolkit API"

**æ­£ç¡®é…ç½®** (å¿…éœ€):
  â˜‘ Restrict key
  â”œâ”€ Cloud Firestore API âœ“
  â”œâ”€ Cloud Storage API âœ“
  â”œâ”€ Identity Toolkit API âœ“ (MUST HAVE!)
  â”œâ”€ Firebase Authentication API âœ“
  â”œâ”€ Firebase Management API âœ“
  â””â”€ [å…¶ä»–å·²å¯ç”¨çš„ Firebase æœåŠ¡]

ç‰¹åˆ«æ³¨æ„:
  å¿…é¡»åŒ…å« "Identity Toolkit API"
  è¿™ä¸ª API ç”¨äº signUp / signIn æ“ä½œ
```

#### 1.5 å¦‚æœçœ‹ä¸åˆ° "Identity Toolkit API"

```
å¦‚æœåœ¨åˆ—è¡¨ä¸­æ‰¾ä¸åˆ° "Identity Toolkit API":

1. ç‚¹å‡» "Unrestricted" é€‰é¡¹
   (å…è®¸æ‰€æœ‰ API è®¿é—®)

2. ç‚¹å‡» Save

3. ç­‰å¾… 2-3 åˆ†é’Ÿç”Ÿæ•ˆ

4. è¿”å›åº”ç”¨æµ‹è¯•ç™»å½•

å¦‚æœè¿™æ ·èƒ½ç™»å½•æˆåŠŸï¼Œè¯´æ˜ä¹‹å‰çš„ API é™åˆ¶å¤ªä¸¥æ ¼äº†
```

#### 1.6 ä¿å­˜æ›´æ”¹

```
ç‚¹å‡»é¡µé¢åº•éƒ¨çš„ [Save] æŒ‰é’®
```

---

### Step 2ï¸âƒ£: éªŒè¯ API å¯†é’¥è®¾ç½® (3åˆ†é’Ÿ)

#### 2.1 æ£€æŸ¥ Application restrictions

```
åœ¨åŒä¸€ä¸ª API å¯†é’¥ç¼–è¾‘é¡µé¢ä¸­ï¼ŒæŸ¥æ‰¾ "Application restrictions" éƒ¨åˆ†

é€‰é¡¹ A: HTTP Referrer (ç½‘ç«™)
  â˜‘ HTTP referrers (websites)

  å¦‚æœé€‰æ‹©æ­¤é¡¹ï¼Œéœ€è¦æ·»åŠ å…è®¸çš„æ¥æº:
  âœ“ localhost:5173
  âœ“ localhost:3000
  âœ“ ä½ çš„å®é™…åŸŸå

é€‰é¡¹ B: ä¸é™åˆ¶ (ä»…ç”¨äºæµ‹è¯•)
  â˜ (None)

  å…è®¸å¯†é’¥ä»ä»»ä½•åœ°æ–¹ä½¿ç”¨
  ä¸å®‰å…¨ï¼Œä½†å¯ç”¨äºæµ‹è¯•

æ¨è: é€‰æ‹© "HTTP Referrer" å¹¶æ·»åŠ ä½ çš„åŸŸå
```

#### 2.2 æ£€æŸ¥å…¶ä»–é…ç½®

```
ç¡®è®¤ä»¥ä¸‹è®¾ç½®:

â˜‘ å¯†é’¥å·²å¯ç”¨ (ä¸æ˜¯ç¦ç”¨çŠ¶æ€)
â˜‘ API é™åˆ¶å·²æ­£ç¡®é…ç½®
â˜‘ Application restrictions å·²è®¾ç½®
â˜‘ ç‚¹å‡»äº† Save æŒ‰é’®
```

---

### Step 3ï¸âƒ£: æ¸…é™¤æ‰€æœ‰ç¼“å­˜ (2åˆ†é’Ÿ) **[é‡è¦]**

#### 3.1 æµè§ˆå™¨ç¼“å­˜

```
1. æŒ‰ Ctrl+Shift+Del

2. é€‰æ‹©æ‰€æœ‰é¡¹ç›®:
   â˜‘ Cookies and other site data
   â˜‘ Cached images and files
   â˜‘ Cached files and settings
   â˜‘ Hosted app data

3. æ—¶é—´èŒƒå›´: All time

4. ç‚¹å‡» Clear data
```

#### 3.2 LocalStorage æ¸…ç©º

```
F12 â†’ Application â†’ Local Storage

å¯¹äºä½ çš„åº”ç”¨åŸŸå:
  å³é”®ç‚¹å‡» â†’ Clear All
```

#### 3.3 IndexedDB æ¸…ç©º

```
F12 â†’ Application â†’ IndexedDB

å¯¹äºä½ çš„åº”ç”¨:
  å³é”®ç‚¹å‡» â†’ Delete Database
```

---

### Step 4ï¸âƒ£: åˆ·æ–°é¡µé¢å¹¶é‡æ–°æµ‹è¯• (1åˆ†é’Ÿ)

```
1. å®Œå…¨å…³é—­æµè§ˆå™¨
   (ä¸æ˜¯ç®€å•åˆ·æ–°ï¼Œè€Œæ˜¯å®Œå…¨å…³é—­)

2. é‡æ–°æ‰“å¼€æµè§ˆå™¨

3. è¾“å…¥åº”ç”¨ URL

4. å°è¯•æ³¨å†Œæˆ–ç™»å½•

é¢„æœŸç»“æœ:
  âœ… æˆåŠŸ: è¿›å…¥ç³»ç»Ÿ
  âŒ ä»å¤±è´¥: ç»§ç»­ä¸‹ä¸€æ­¥
```

---

## ğŸ” å¦‚æœä»ç„¶å¤±è´¥ - æ›¿ä»£æ–¹æ¡ˆ

### æ–¹æ¡ˆ A: ç¦ç”¨ API é™åˆ¶ (å¿«é€Ÿæµ‹è¯•)

```
è¿™æ˜¯è¯Šæ–­é—®é¢˜çš„æœ€å¿«æ–¹æ³•:

1. Firebase Console â†’ API keys
2. é€‰æ‹©ä½ çš„ API å¯†é’¥
3. æ‰¾åˆ° "API restrictions"
4. é€‰æ‹© â˜ (None)
   è¿™å…è®¸å¯†é’¥æ— é™åˆ¶åœ°è®¿é—®æ‰€æœ‰ API
5. Save

ç°åœ¨é‡è¯•ç™»å½•/æ³¨å†Œ

å¦‚æœè¿™æ ·æˆåŠŸäº†:
  âœ“ é—®é¢˜æ˜¯ API é™åˆ¶é…ç½®ä¸å½“
  â†’ è¿”å›æ­¥éª¤ 1.4 æ­£ç¡®é…ç½®é™åˆ¶

å¦‚æœè¿™æ ·è¿˜æ˜¯å¤±è´¥:
  âœ“ é—®é¢˜å¯èƒ½æ›´æ·±å±‚
  â†’ ç»§ç»­æ–¹æ¡ˆ B
```

### æ–¹æ¡ˆ B: ç”Ÿæˆæ–°çš„ API å¯†é’¥

```
å¦‚æœä¸Šé¢çš„æ–¹æ³•éƒ½ä¸è¡Œï¼Œç”Ÿæˆå…¨æ–°çš„å¯†é’¥:

1. Firebase Console â†’ API keys
2. ç‚¹å‡» "Create API Key"
3. é€‰æ‹© "Browser key"
4. æ–°å¯†é’¥ä¼šè‡ªåŠ¨ç”Ÿæˆ
5. å¤åˆ¶æ–°å¯†é’¥å€¼
6. æ›´æ–°ä½ çš„ firebase-config.js:
   apiKey: "æ–°çš„å¯†é’¥å€¼"
7. æ¸…é™¤ç¼“å­˜å¹¶é‡è¯•
```

### æ–¹æ¡ˆ C: åˆ é™¤å¹¶é‡æ–°åˆ›å»º API å¯†é’¥

```
å¦‚æœæ–°å¯†é’¥ä»ç„¶ä¸è¡Œ:

1. Firebase Console â†’ API keys
2. ç‚¹å‡»å½“å‰å¯†é’¥æ—çš„ä¸‰ç‚¹èœå•
3. é€‰æ‹© "Delete"
4. ç¡®è®¤åˆ é™¤
5. ç‚¹å‡» "Create API Key"
6. é€‰æ‹© "Browser key"
7. å¤åˆ¶æ–°å¯†é’¥
8. æ›´æ–° firebase-config.js
9. é‡æ–°é…ç½® API é™åˆ¶ (æŒ‰æ­¥éª¤ 1.4)
10. æ¸…é™¤ç¼“å­˜å¹¶é‡è¯•
```

---

## ğŸ› ï¸ é«˜çº§è¯Šæ–­

### æ£€æŸ¥ Firebase é¡¹ç›®é…ç½®

```
Firebase Console ä¸­æ£€æŸ¥:

1. Project settings â†’ General
   âœ“ é¡¹ç›® ID: dental-clinic-demo-ce94b
   âœ“ é¡¹ç›®ç¼–å·: [è®°ä¸‹è¿™ä¸ª]

2. Authentication â†’ Settings
   âœ“ Sign-in method: Email/Password (å·²å¯ç”¨)
   âœ“ Authorized domains: åŒ…å«ä½ çš„åŸŸå

3. API & Services
   âœ“ å¯ç”¨çš„ API ä¸­åº”è¯¥åŒ…å«:
     - Identity and Access Management API
     - Identity Toolkit API
     - Firebase Authentication API
```

### åœ¨ Firebase Console ä¸­æµ‹è¯•

```
1. Firebase Console â†’ Authentication â†’ Users
2. ç‚¹å‡» "Create user"
3. Email: test@test.com
4. Password: TestPassword123!
5. ç‚¹å‡» Create user

å¦‚æœæˆåŠŸåˆ›å»º:
  âœ“ Firestore è§„åˆ™æ­£å¸¸
  âœ“ Auth ç³»ç»Ÿæ­£å¸¸
  âœ“ é—®é¢˜å¯èƒ½åœ¨å‰ç«¯é…ç½®

å¦‚æœåˆ›å»ºå¤±è´¥:
  âœ“ é—®é¢˜åœ¨ Firebase é¡¹ç›®é…ç½®æœ¬èº«
  âœ“ éœ€è¦è”ç³» Firebase æ”¯æŒ
```

---

## ğŸ“‹ å®Œæ•´æ£€æŸ¥æ¸…å•

åœ¨ç»§ç»­ä¹‹å‰ï¼Œç¡®è®¤ä½ å·²æ£€æŸ¥äº†:

### API å¯†é’¥é…ç½®
- [ ] API å¯†é’¥å·²å¯ç”¨ (ä¸æ˜¯ç¦ç”¨)
- [ ] API restrictions åŒ…å« "Identity Toolkit API"
- [ ] Application restrictions å·²æ­£ç¡®è®¾ç½®
- [ ] ç‚¹å‡»äº† Save æŒ‰é’®
- [ ] ç­‰å¾…äº† 2-3 åˆ†é’Ÿè®©æ›´æ”¹ç”Ÿæ•ˆ

### ç¼“å­˜æ¸…ç©º
- [ ] æµè§ˆå™¨ç¼“å­˜å·²æ¸…ç©º (Ctrl+Shift+Del)
- [ ] LocalStorage å·²æ¸…ç©º (F12 â†’ Application)
- [ ] IndexedDB å·²æ¸…ç©º
- [ ] å®Œå…¨å…³é—­æµè§ˆå™¨åé‡æ–°æ‰“å¼€

### ä»£ç é…ç½®
- [ ] firebase-config.js ä½¿ç”¨çš„æ˜¯æ–°çš„ API å¯†é’¥
- [ ] æ²¡æœ‰å¤šä¸ªç‰ˆæœ¬çš„é…ç½®æ–‡ä»¶å†²çª
- [ ] æ²¡æœ‰ç¼“å­˜çš„æ—§é…ç½®

### Firebase Console é…ç½®
- [ ] Email/Password è®¤è¯å·²å¯ç”¨
- [ ] é¡¹ç›®å¤„äºæ´»è·ƒçŠ¶æ€ (æœªè¶…é…é¢)
- [ ] Firestore è§„åˆ™å…è®¸è®¤è¯æ“ä½œ

---

## ğŸ¯ é¢„æœŸçš„æˆåŠŸæ ‡å¿—

å½“é—®é¢˜è§£å†³æ—¶ï¼Œä½ ä¼šçœ‹åˆ°:

```
1. æ³¨å†Œæˆ–ç™»å½•é¡µé¢åŠ è½½æˆåŠŸ
2. è¾“å…¥é‚®ç®±å’Œå¯†ç 
3. ç‚¹å‡» "Sign Up" æˆ– "Sign In"
4. è¯·æ±‚å‘é€åˆ° identitytoolkit.googleapis.com
5. å“åº”çŠ¶æ€: 200 (ä¸æ˜¯ 403)
6. é¡µé¢é‡å®šå‘åˆ° Dashboard
7. èƒ½çœ‹åˆ°ç”¨æˆ·ä¿¡æ¯æˆ–èœå•
```

---

## ğŸ“ å¦‚æœæ‰€æœ‰æ–¹æ³•éƒ½ä¸è¡Œ

æ”¶é›†ä»¥ä¸‹ä¿¡æ¯:

1. **Firebase Console ä¸­çš„ API å¯†é’¥è®¾ç½®æˆªå›¾**
   - æ˜¾ç¤º API restrictions éƒ¨åˆ†
   - æ˜¾ç¤º Application restrictions éƒ¨åˆ†

2. **å®Œæ•´çš„é”™è¯¯å †æ ˆ**
   - F12 Console ä¸­çš„å®Œæ•´é”™è¯¯ä¿¡æ¯

3. **Network æ ‡ç­¾ä¸­çš„è¯·æ±‚/å“åº”**
   - F12 â†’ Network
   - æ‰¾åˆ° identitytoolkit.googleapis.com çš„è¯·æ±‚
   - ç‚¹å‡»å®ƒï¼ŒæŸ¥çœ‹ Response æ ‡ç­¾ä¸­çš„å®Œæ•´å“åº”ä½“

4. **ä½ çš„ firebase-config.js å†…å®¹**
   - (éšè—æ•æ„Ÿå¯†é’¥å€¼)

5. **é¡¹ç›® ID å’Œ API å¯†é’¥é¦–å°¾å­—ç¬¦**
   - é¡¹ç›® ID: dental-clinic-demo-ce94b
   - API å¯†é’¥: AIzaSyDP2...cWqtA

---

**çŠ¶æ€**: ğŸ”§ æ·±åº¦ä¿®å¤æŒ‡å—
**ç›®æ ‡**: è§£å†³ API å¯†é’¥æƒé™ 403 é”™è¯¯
**é¢„è®¡æˆåŠŸç‡**: 99%

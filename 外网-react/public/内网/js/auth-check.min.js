class InternalAuthChecker{constructor(){this.allowedRoles=["admin","owner"],this.loginPagePath="../å¤–ç½‘/landingpage.html",this.authCheckKey="internal_auth_checked"}checkAuth(){try{if("true"===sessionStorage.getItem(this.authCheckKey))return!0;const e=this.getUserData();return e?this.isValidRole(e.role)?(sessionStorage.setItem(this.authCheckKey,"true"),this.onAuthSuccess(e),!0):(this.handleAuthFailure(`ç”¨æˆ·è§’è‰² "${e.role}" æ— æƒè®¿é—®å†…ç½‘ç®¡ç†ç³»ç»Ÿ`),!1):(this.handleAuthFailure("ç”¨æˆ·æœªç™»å½•"),!1)}catch(e){return this.handleAuthFailure("è®¤è¯æ£€æŸ¥è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯"),!1}}getUserData(){try{const e=["currentUser","user","userData","authUser"];for(const t of e){const e=localStorage.getItem(t);if(e){const t=JSON.parse(e);if(t&&(t.role||t.email))return t}}return null}catch(e){return null}}isValidRole(e){return e&&this.allowedRoles.includes(e.toLowerCase())}handleAuthFailure(e){this.showAuthMessage(e),setTimeout(()=>{this.redirectToLogin()},2e3)}onAuthSuccess(e){this.updateUserDisplay(e)}redirectToLogin(){try{window.location.href=this.loginPagePath}catch(e){window.location.replace(this.loginPagePath)}}showAuthMessage(e){const t=document.createElement("div");t.id="auth-message",t.style.cssText="\n            position: fixed;\n            top: 50%;\n            left: 50%;\n            transform: translate(-50%, -50%);\n            background: #f44336;\n            color: white;\n            padding: 20px;\n            border-radius: 8px;\n            z-index: 9999;\n            font-family: Arial, sans-serif;\n            text-align: center;\n            box-shadow: 0 4px 6px rgba(0,0,0,0.1);\n        ",t.innerHTML=`\n            <div style="margin-bottom: 10px;">\n                <i style="font-size: 24px;">ğŸ”’</i>\n            </div>\n            <div>${e}</div>\n            <div style="margin-top: 10px; font-size: 12px;">\n                æ­£åœ¨é‡å®šå‘åˆ°ç™»å½•é¡µé¢...\n            </div>\n        `,document.body.appendChild(t),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},2e3)}updateUserDisplay(e){const t=document.querySelector(".user-name"),n=document.querySelector(".user-role");if(t&&(t.textContent=e.displayName||e.email||"Admin"),n){const t="owner"===e.role?"Boss":"Admin";n.textContent=t}}logout(){sessionStorage.removeItem(this.authCheckKey);["currentUser","user","userData","authUser"].forEach(e=>{localStorage.removeItem(e)}),this.redirectToLogin()}getCurrentUserRole(){const e=this.getUserData();return e?e.role:null}isBoss(){return"owner"===this.getCurrentUserRole()}isAdmin(){const e=this.getCurrentUserRole();return"admin"===e||"owner"===e}}function initializeAuth(){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{window.authChecker.checkAuth()}):window.authChecker.checkAuth()}window.authChecker=new InternalAuthChecker,window.initializeAuth=initializeAuth,window.checkAuth=()=>window.authChecker.checkAuth(),window.logout=()=>window.authChecker.logout(),window.getCurrentUserRole=()=>window.authChecker.getCurrentUserRole(),window.isBoss=()=>window.authChecker.isBoss(),window.isAdmin=()=>window.authChecker.isAdmin();